require(ggplot2)
require(extRemes)
library(tidyverse)
source('../../../UNSEEN-open-Deep-Sky/src/evt_plot.r')
SEAS5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/SEAS5_events.csv")
ERA5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/ERA5_events.csv")
SEAS5_events$year <- ymd(paste0(SEAS5_events$year, "-01-01"))
ERA5_events$year <- ymd(paste0(ERA5_events$year, "-01-01"))
SEAS5_events_hindcast <- SEAS5_events[
SEAS5_events$year < '2017-02-01',]
ERA5_events_hindcast <- ERA5_events[
ERA5_events$year > '1981-02-01' &
ERA5_events$year < '2017-02-01',]
UNSEEN_bc <- SEAS5_events[SEAS5_events$number < 25,]
UNSEEN_bc$t2m <- (UNSEEN_bc$t2m +
mean(ERA5_events_hindcast$t2m) - mean(SEAS5_events_hindcast$t2m)
)
UNSEEN_bc$d2m <- (UNSEEN_bc$d2m +
mean(ERA5_events_hindcast$d2m) - mean(SEAS5_events_hindcast$d2m)
)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1990-02-01' &
UNSEEN_bc$year > '1982-02-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2020-01-01',]
View(UNSEEN_1)
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
require(UNSEEN)
require(ggplot2)
require(extRemes)
library(tidyverse)
source('../../../UNSEEN-open-Deep-Sky/src/evt_plot.r')
SEAS5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/SEAS5_events.csv")
ERA5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/ERA5_events.csv")
SEAS5_events$year <- ymd(paste0(SEAS5_events$year, "-01-01"))
ERA5_events$year <- ymd(paste0(ERA5_events$year, "-01-01"))
SEAS5_events_hindcast <- SEAS5_events[
SEAS5_events$year < '2017-02-01',]
ERA5_events_hindcast <- ERA5_events[
ERA5_events$year > '1981-02-01' &
ERA5_events$year < '2017-02-01',]
UNSEEN_bc <- SEAS5_events[SEAS5_events$number < 25,]
View(UNSEEN_bc)
UNSEEN_bc$t2m <- (UNSEEN_bc$t2m +
mean(ERA5_events_hindcast$t2m) - mean(SEAS5_events_hindcast$t2m)
)
View(UNSEEN_bc)
View(ERA5_events_hindcast)
View(SEAS5_events_hindcast)
SEAS5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/SEAS5_events.csv")
ERA5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/ERA5_events.csv")
SEAS5_events$year <- ymd(paste0(SEAS5_events$year, "-01-01"))
ERA5_events$year <- ymd(paste0(ERA5_events$year, "-01-01"))
SEAS5_events <- SEAS5_events[SEAS5_events$number < 25,]
SEAS5_events_hindcast <- SEAS5_events[
SEAS5_events$year < '2017-02-01',]
ERA5_events_hindcast <- ERA5_events[
ERA5_events$year > '1981-02-01' &
ERA5_events$year < '2017-02-01',]
UNSEEN_bc$t2m <- (UNSEEN_bc$t2m +
mean(ERA5_events_hindcast$t2m) - mean(SEAS5_events_hindcast$t2m)
)
View(UNSEEN_bc)
require(UNSEEN)
require(ggplot2)
require(extRemes)
library(tidyverse)
source('../../../UNSEEN-open-Deep-Sky/src/evt_plot.r')
SEAS5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/SEAS5_events.csv")
ERA5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/ERA5_events.csv")
SEAS5_events$year <- ymd(paste0(SEAS5_events$year, "-01-01"))
ERA5_events$year <- ymd(paste0(ERA5_events$year, "-01-01"))
SEAS5_events <- SEAS5_events[SEAS5_events$number < 25,]
SEAS5_events_hindcast <- SEAS5_events[
SEAS5_events$year < '2017-02-01',]
ERA5_events_hindcast <- ERA5_events[
ERA5_events$year > '1981-02-01' &
ERA5_events$year < '2017-02-01',]
UNSEEN_bc$t2m <- (UNSEEN_bc$t2m +
mean(ERA5_events_hindcast$t2m) - mean(SEAS5_events_hindcast$t2m)
)
require(UNSEEN)
require(ggplot2)
require(extRemes)
library(tidyverse)
source('../../../UNSEEN-open-Deep-Sky/src/evt_plot.r')
SEAS5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/SEAS5_events.csv")
ERA5_events <- read.csv("../../data/UNSEEN/wildfire/preprocessed/ERA5_events.csv")
SEAS5_events$year <- ymd(paste0(SEAS5_events$year, "-01-01"))
ERA5_events$year <- ymd(paste0(ERA5_events$year, "-01-01"))
SEAS5_events <- SEAS5_events[SEAS5_events$number < 25,]
SEAS5_events_hindcast <- SEAS5_events[
SEAS5_events$year < '2017-02-01',]
ERA5_events_hindcast <- ERA5_events[
ERA5_events$year > '1981-02-01' &
ERA5_events$year < '2017-02-01',]
UNSEEN_bc <- SEAS5_events
UNSEEN_bc$t2m <- (UNSEEN_bc$t2m +
mean(ERA5_events_hindcast$t2m) - mean(SEAS5_events_hindcast$t2m)
)
View(UNSEEN_bc)
UNSEEN_bc$d2m <- (UNSEEN_bc$d2m +
mean(ERA5_events_hindcast$d2m) - mean(SEAS5_events_hindcast$d2m)
)
View(UNSEEN_bc)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1990-02-01' &
UNSEEN_bc$year > '1982-02-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2020-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 50, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gumbel_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1991-02-01' &
UNSEEN_bc$year > '1981-02-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2014-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 50, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gumbel_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2001-02-01' &
UNSEEN_bc$year > '1981-02-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2001-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 50, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gumbel_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2001-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2001-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
return_periods <- c(5, 10, 50, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gumbel_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
plot_return_periods <- c(seq(from = 1.01, to = 1.5, by = 0.1), 1.7, 2, 3, 5, 10, 20, 50, 80, 100, 120, 200, 250, 300, 500, 800, 2000, 5000)
plot_return_levels_1 <- return.level(gumbel_fit_1, return.period = plot_return_periods)
plot_return_levels_2 <- return.level(gumbel_fit_2, return.period = plot_return_periods)
plot_return_levels_1
2023-15
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1996-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2008-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 50, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gumbel_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1990-01-01' &
UNSEEN_bc$year > '1981-01-01',]
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
return_periods <- c(5, 10, 50, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
print(return_levels_1)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1996-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2008-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 50, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1991-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2013-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1991-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2014-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1991-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2015-01-01',]
View(UNSEEN_2)
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gubmel_fit_2, return.period = return_periods)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gubmel_fit_2, return.period = return_periods)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gubmel_fit_2, return.period = return_periods)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1991-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2015-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gubmel_fit_2, return.period = return_periods)
return_levels_2 <- return.level(gumbel_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1991-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2015-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1996-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2014-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1996-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2012-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1995-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2012-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
summary(UNSEEN_bc)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2001-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2002-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2002-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2003-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2003-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2003-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2000-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2000-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2000-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2003-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2000-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2004-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2000-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2005-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '2000-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2006-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gumbel_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1996-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2008-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1996-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2009-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1996-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2010-01-01',]
summary(UNSEEN_1)
summary(UNSEEN_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1993-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2013-01-01',]
summary(UNSEEN_1)
summary(UNSEEN_2)
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gumbel_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gumbel_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1995-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2011-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1999-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2019-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1999-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2009-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1999-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2008-01-01',]
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1999-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2007-01-01',]
summary(UNSEEN_1)
summary(UNSEEN_2)
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
UNSEEN_1 <- UNSEEN_bc[UNSEEN_bc$year < '1998-01-01' &
UNSEEN_bc$year > '1981-01-01',]
UNSEEN_2 <- UNSEEN_bc[UNSEEN_bc$year >= '2008-01-01',]
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
lr.test(gumbel_fit_1, gev_fit_1)
lr.test(gev_fit_1, gumbel_fit_1)
summary(gev_fit_1)
summary(gev_fit_2)
summary(gumbel_fit_1)
summary(gumbel_fit_2)
summary(UNSEEN_1)
summary(UNSEEN_2)
obs_1 <- ERA5_events[ERA5_events$year < '1985-02-01' &
ERA5_events$year > '1982-02-01',]
obs_2 <- ERA5_events[ERA5_events$year > '2020-01-01',]
gev_fit_1 <- fevd(UNSEEN_1$t2m, type = 'GEV', use.phi = FALSE)
gev_fit_2 <- fevd(UNSEEN_2$t2m, type = 'GEV', use.phi = FALSE)
gumbel_fit_1 <- fevd(UNSEEN_1$t2m, type = 'Gumbel', use.phi = FALSE)
gumbel_fit_2 <- fevd(UNSEEN_2$t2m, type = 'Gumbel', use.phi = FALSE)
# rvs_1 <- ci.fevd(gumbel_fit_1, alpha = 0.05, type = "return.level", return.period = 60, method = "normal")
# rvs_2 <- ci.fevd(gumbel_fit_2, alpha = 0.05, type = "return.level", return.period = 6, method = "normal")
return_periods <- c(5, 10, 20, 40, 50, 70, 100)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
rvs_1 <- ci.fevd(gev_fit_1, alpha = 0.05, type = "return.level", return.period = 100, method = "normal")
rvs_2 <- ci.fevd(gev_fit_2, alpha = 0.05, type = "return.level", return.period = 5, method = "normal")
rvs_1
rvs_2
return_periods <- c(5, 10, 20, 40, 50, 70, 100, 120)
return_levels_1 <- return.level(gev_fit_1, return.period = return_periods)
return_levels_2 <- return.level(gev_fit_2, return.period = return_periods)
print(return_levels_1)
print(return_levels_2)
plot_return_periods <- c(seq(from = 1.01, to = 1.5, by = 0.1), 1.7, 2, 3, 5, 10, 20, 50, 80, 100, 120, 200, 250, 300, 500, 800, 2000, 5000)
plot_return_levels_1 <- return.level(gumbel_fit_1, return.period = plot_return_periods)
plot_return_levels_2 <- return.level(gumbel_fit_2, return.period = plot_return_periods)
summary(UNSEEN_1)
summary(UNSEEN_2)
