x = "Time",
y = "FWINX") +
theme_minimal()
era5_yearly_max <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_yearly_max.csv')
era5_yearly_max$time <- as.Date(era5_yearly_max$time)
era5_yearly_max <- era5_yearly_max[order(era5_yearly_max$time), ]
View(era5_yearly_max)
ggplot(era5_yearly_max, aes(x = time, y = fwinx)) +
geom_line() +  # Line plot
labs(title = "Plot of FWINX over Time",
x = "Time",
y = "FWINX") +
theme_minimal()  # Optional: U
gev_fit_nonstat <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)),
scale.fun = ~c(1:length(era5_yearly_max$time)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat
gev_fit_nonstat <- fevd(x = era5_monthly_max$fwinx,
location.fun = ~c(1:length(era5_monthly_max$time)),
scale.fun = ~c(1:length(era5_monthly_max$time)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_yearly <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)),
scale.fun = ~c(1:length(era5_yearly_max$time)),
use.phi = TRUE,
type = "GEV")
plot(gev_fit_nonstat__yearly, type = "rl", rperiods = c(10, 20, 50, 100, 200, 500))
plot(gev_fit_nonstat_yearly, type = "rl", rperiods = c(10, 20, 50, 100, 200, 500))
plot(gev_fit_nonstat, type = "density")
plot(gev_fit_nonstat_yearly, type = "density")
plot(gev_fit_nonstat_yearly, type = "rl", rperiods = c(10, 20, 50, 100, 200, 500))
era5_yearly_max$year_index <- as.numeric(era5_yearly_max$year) - min(as.numeric(era5_yearly_max$year))
View(era5_yearly_max)
qcovs <- make.qcov(gev_fit_nonstat_yearly, vals = list(mu1 = c(1,50),phi1 = c(1,50)))
rvs <- ci(gev_fit_nonstat_yearly, alpha = 0.05, type = 'return.level', return.period = 20,
method = "normal", qcov = qcovs[2, ], qcov.base = qcovs[1, ])
rvs_base <- ci(gev_fit_nonstat_yearly, alpha = 0.05, type = 'return.level', return.period = 20,
method = "normal", qcov = qcovs[1, ])
rvs_trend_percent <- 100 * (rvs_obs / rvs_obs_base[2])
print(paste('Observed trend and uncertainty:', as.character(rvs_obs_trend_percent[1, 2]),
as.character(rvs_obs_trend_percent[1, 1]), as.character(rvs_obs_trend_percent[1, 3])))
print(paste('Observed trend and uncertainty:', as.character(rvs_trend_percent[1, 2]),
as.character(rvs_trend_percent[1, 1]), as.character(rvs_trend_percent[1, 3])))
rvs <- ci(gev_fit_nonstat_yearly, alpha = 0.05, type = 'return.level', return.period = 20,
method = "normal", qcov = qcovs[2, ], qcov.base = qcovs[1, ])
rvs_base <- ci(gev_fit_nonstat_yearly, alpha = 0.05, type = 'return.level', return.period = 20,
method = "normal", qcov = qcovs[1, ])
rvs_trend_percent <- 100 * (rvs / rvs_base[2])
# Print the observed trend and uncertainty
print(paste('Observed trend and uncertainty:', as.character(rvs_trend_percent[1, 2]),
as.character(rvs_trend_percent[1, 1]), as.character(rvs_trend_percent[1, 3])))
RV_100yr_1973=rvs_base[2]
GEV_2023=ci(gev_fit_nonstat_yearly,alpha = 0.05,type='return.level',return.period = 100,method ="normal",qcov=qcovs[2,])  #Calculate the return values and confidence intervals for each
which.min(abs(GEV_2023[,2] - RV_100yr_1973)) #The 41-year value!. Repeat for confidence intervals: GEV_2015[,1] and GEV_2015[,3]
which.min(abs(GEV_2023[,2] - RV_100yr_1973)) #The 41-year value!. Repeat for confidence intervals: GEV_2015[,1] and GEV_2015[,3]
return.level(gev_fit_nonstat_yearly, return.period = c(1, 5, 10, 20, 100), qcov = qcovs)
> return.level(gev_fit_nonstat_yearly, return.period = c(1, 5, 10, 20, 100))
return.level(gev_fit_nonstat_yearly, return.period = c(1, 5, 10, 20, 100))
return.level(x = gev_fit_nonstat_yearly, return.period = c(1, 5, 10, 20, 100))
gev_fit_nonstat_yearly
qcov
qcovs
return.level(x = gev_fit_nonstat_yearly, return.period = c(1, 5, 10, 20, 100), qcov = qcovs)
return.level(x = gev_fit_nonstat_yearly, return.period = c(5, 10, 20, 100), qcov = qcovs)
era5_yearly_max$year_index <- as.numeric(era5_yearly_max$year) - min(as.numeric(era5_yearly_max$year))
qcovs <- make.qcov(gev_fit_nonstat_yearly, vals = list(mu1 = c(1,50),phi1 = c(1,50)))
rvs <- ci(gev_fit_nonstat_yearly, alpha = 0.05, type = 'return.level', return.period = 20,
method = "normal", qcov = qcovs[2, ], qcov.base = qcovs[1, ])
rvs_base <- ci(gev_fit_nonstat_yearly, alpha = 0.05, type = 'return.level', return.period = 20,
method = "normal", qcov = qcovs[1, ])
rvs_trend_percent <- 100 * (rvs / rvs_base[2])
# Print the observed trend and uncertainty
print(paste('Observed trend and uncertainty:', as.character(rvs_trend_percent[1, 2]),
as.character(rvs_trend_percent[1, 1]), as.character(rvs_trend_percent[1, 3])))
rvs_trend_percent
GEV_2023=ci(gev_fit_nonstat_yearly,alpha = 0.05,type='return.level',return.period = 100,method ="normal",qcov=qcovs[2,])  #Calculate the return values and confidence intervals for each
which.min(abs(GEV_2023[,2] - RV_100yr_1973)) #The 41-year value!. Repeat for confidence intervals: GEV_2015[,1] and GEV_2015[,3]
which.min(abs(GEV_2023[,2] - RV_100yr_1973)) #The 41-year value!. Repeat for confidence intervals: GEV_2015[,1] and GEV_2015[,3]
return.level(x = gev_fit_nonstat_yearly, return.period = c(5, 10, 20, 30, 40, 50, 100), qcov = qcovs)
return.level(x = gev_fit_nonstat_yearly, return.period = c(5, 10, 15, 20, 30, 40, 50, 100), qcov = qcovs)
ggplot(era5_yearly_max, aes(x = time, y = fwinx)) +
geom_line() +  # Line plot
labs(title = "Plot of FWINX over Time",
x = "Time",
y = "FWINX") +
theme_minimal()  # Optional: Use a minimal theme for a cleaner look
plot(gev_fit_nonstat_yearly, type = "qq")
plot(gev_fit_nonstat_yearly, type = "hist")
qcovs
era5_yearly_max$year_index <- era5_yearly_max$time - min(era5_yearly_max$time)
gev_fit_nonstat_yearly <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)),
scale.fun = ~c(1:length(era5_yearly_max$time)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_yearly_2 <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~year_index,
scale.fun = ~year_index,
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_yearly <- fevd(x = era5_yearly_max,
location.fun = ~c(1:length(era5_yearly_max$time)),
scale.fun = ~c(1:length(era5_yearly_max$time)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_yearly_2 <- fevd(x = era5_yearly_max,
location.fun = ~year_index,
scale.fun = ~year_index,
use.phi = TRUE,
type = "GEV")
era5_yearly_max$year_index <- era5_yearly_max$time - min(era5_yearly_max$time)
gev_fit_nonstat_yearly_2 <- fevd(x = era5_yearly_max,
location.fun = ~year_index,
scale.fun = ~year_index,
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_yearly_accelerating <- fevd(x = era5_yearly_max,
location.fun = ~c(1:length(era5_yearly_max$time)) + I(c(1:length(era5_yearly_max$time))^2),
scale.fun = ~c(1:length(era5_yearly_max$time)) + I(c(1:length(era5_yearly_max$time))^2),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_yearly <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)),
scale.fun = ~c(1:length(era5_yearly_max$time)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_yearly_accelerating <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)) + I(c(1:length(era5_yearly_max$time))^2),
scale.fun = ~c(1:length(era5_yearly_max$time)) + I(c(1:length(era5_yearly_max$time))^2),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_yearly <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)),
scale.fun = ~c(1:length(era5_yearly_max$time)),
use.phi = TRUE,
type = "GEV")
gev_fit_accelerating <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)) + I(c(1:length(era5_yearly_max$time))^2),
scale.fun = ~c(1:length(era5_yearly_max$time)) + I(c(1:length(era5_yearly_max$time))^2),
use.phi = TRUE,
type = "GEV")
aic_original <- AIC(gev_fit_nonstat_yearly)
gev_fit_nonstat_yearly
gev_fit_accelerating
gev_fit_accelerating <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)) + I(c(1:length(era5_yearly_max$time))^2),
scale.fun = ~c(1:length(era5_yearly_max$time)),
use.phi = TRUE,
type = "GEV")
gev_fit_accelerating
lr.test(gev_fit_nonstat_yearly, gev_fit_accelerating)
gev_fit_nonstat_yearly <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)),
scale.fun = ~c(1:length(era5_yearly_max$time)),
use.phi = TRUE,
type = "GEV")
gev_fit_accelerating <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~c(1:length(era5_yearly_max$time)) + I(c(1:length(era5_yearly_max$time))^2),
#scale.fun = ~c(1:length(era5_yearly_max$time)),
use.phi = TRUE,
type = "GEV")
lr.test(gev_fit_nonstat_yearly, gev_fit_accelerating)
gev_fit_accelerating
gev_fit_nonstat_yearly
qcovs <- make.qcov(gev_fit_accelerating, vals = list(mu1 = c(1,50),phi1 = c(1,50)))
lr.test(gev_fit_nonstat_yearly, gev_fit_accelerating)
era5_yearly_max$index <- 1:length(era5_yearly_max$time)
# Fit the model using this index for both linear and quadratic terms
gev_fit_accelerating <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~ index + I(index^2),
scale.fun = ~ index + I(index^2),
use.phi = TRUE,
type = "GEV")
era5_yearly_max$index <- 1:length(era5_yearly_max$time)
# Fit the model using this index for both linear and quadratic terms
gev_fit_accelerating <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~ era5_yearly_maxindex + I(era5_yearly_maxindex^2),
scale.fun = ~ era5_yearly_maxindex + I(era5_yearly_maxindex^2),
use.phi = TRUE,
type = "GEV")
gev_fit_accelerating <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~ era5_yearly_max$index + I(era5_yearly_max$index^2),
scale.fun = ~ era5_yearly_max$index + I(era5_yearly_max$index^2),
use.phi = TRUE,
type = "GEV")
gev_fit_accelerating
gev_fit_accelerating <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~ era5_yearly_max$index + I(era5_yearly_max$index^2),
#scale.fun = ~ era5_yearly_max$index + I(era5_yearly_max$index^2),
use.phi = TRUE,
type = "GEV")
gev_fit_accelerating
qcovs <- make.qcov(gev_fit_accelerating, vals = list(mu1 = c(min(era5_yearly_max$index), max(era5_yearly_max$index)),
phi1 = c(min(era5_yearly_max$index), max(era5_yearly_max$index))))
qcovs <- make.qcov(gev_fit_accelerating, vals = list(b1 = c(min(era5_yearly_max$index), max(era5_yearly_max$index)),
b2 = c(min(era5_yearly_max$index), max(era5_yearly_max$index))))
summary(gev_fit_accelerating)
min_index <- min(era5_yearly_max$index)
max_index <- max(era5_yearly_max$index)
qcovs <- make.qcov(gev_fit_accelerating, vals = list(mu1 = c(min_index, max_index),
mu2 = c(min_index^2, max_index^2)))
gev_fit_accelerating <- fevd(x = era5_yearly_max$fwinx,
location.fun = ~ era5_yearly_max$index + I(era5_yearly_max$index^2),
#scale.fun = ~ era5_yearly_max$index + I(era5_yearly_max$index^2),
use.phi = TRUE,
type = "GEV")
# Correct names must be used, for example:
min_index <- min(era5_yearly_max$index)
max_index <- max(era5_yearly_max$index)
qcovs <- make.qcov(gev_fit_accelerating, vals = list(mu1 = c(min_index, max_index),
mu2 = c(min_index^2, max_index^2)))
return_levels <- return.level(gev_fit_accelerating, return.period = c(5, 10, 15, 20, 30, 40, 50, 100), qcov = qcovs)
print(return_levels)
return_levels <- return.level(gev_fit_accelerating, return.period = c(5, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
min_index_qcov <- make.qcov(gev_fit_accelerating, vals = list(mu1 = min_index, mu2 = min_index^2))
return_level_100yr_min <- return.level(gev_fit_accelerating, return.period = 100, qcov = min_index_qcov)
return_level_100yr_min
find_matching_period <- function(level, lower = 1, upper = 1000) {
uniroot(function(x) return_level_max_index(x)[, "Return.Level"] - level,
lower = lower, upper = upper)$root
}
# Example: Finding the return period matching the 100-year return level at min index
matching_return_period <- find_matching_period(return_level_100yr_min[, "Return.Level"], lower = 1, upper = 1000)
return_level_max_index <- function(return_period) {
max_index_qcov <- make.qcov(gev_fit_accelerating, vals = list(mu1 = max_index, mu2 = max_index^2))
return.level(gev_fit_accelerating, return.period = return_period, qcov = max_index_qcov)
}
find_matching_period <- function(level, lower = 1, upper = 1000) {
uniroot(function(x) return_level_max_index(x)[, "Return.Level"] - level,
lower = lower, upper = upper)$root
}
# Example: Finding the return period matching the 100-year return level at min index
matching_return_period <- find_matching_period(return_level_100yr_min[, "Return.Level"], lower = 1, upper = 1000)
return_level_max_index <- function(return_period) {
max_index_qcov <- make.qcov(gev_fit_accelerating, vals = list(mu1 = max_index, mu2 = max_index^2))
return.level(gev_fit_accelerating, return.period = return_period, qcov = max_index_qcov)
}
# Adjusted uniroot function
find_matching_period <- function(level, lower = 1.1, upper = 1000) {  # start at 1.1 to avoid the error
uniroot(function(x) return_level_max_index(x)[, "Return.Level"] - level,
lower = lower, upper = upper, extendInt = "yes")$root
}
# Assuming return_level_100yr_min is a numeric value of the return level
matching_return_period <- find_matching_period(return_level_100yr_min[1, "Return.Level"], lower = 1.1, upper = 1000)
return_levels <- return.level(gev_fit_accelerating, return.period = c(5, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
return_levels <- return.level(gev_fit_accelerating, return.period = c(5, 6, 7, 8, 9, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
7/100
100/7
plot(gev_fit_nonstat_yearly, type = "rl", rperiods = c(10, 20, 50, 100, 200, 500))
plot(gev_fit_accelerating, type = "rl", rperiods = c(10, 20, 50, 100, 200, 500), )
plot(gev_fit_accelerating, type = "density")
plot(gev_fit_accelerating, type = "qq")
plot(gev_fit_accelerating, type = "hist")
ggplot(era5_yearly_max, aes(x = time, y = fwinx)) +
geom_line() +  # Line plot
labs(title = "Plot of FWINX over Time",
x = "Time",
y = "FWINX") +
theme_minimal()  # Optional: Use a minimal theme for a cleaner look
plot(gev_fit_accelerating, type = "rl", rperiods = c(10, 20, 50, 100, 200, 500), )
plot(gev_fit_accelerating, type = "density")
plot(gev_fit_accelerating, type = "qq")
return_levels_df <- as.data.frame(return_levels)
names(return_levels_df) <- c("Return_Period", "Start", "End")
return_levels_df <- as.data.frame(return_levels)
return_levels_df
return_levels
return_levels <- data.frame(
`5-year level` = c(240.1808, 275.9003),
`6-year level` = c(243.4407, 279.1603),
`7-year level` = c(246.0670, 281.7865),
`8-year level` = c(248.2564, 283.9760),
`9-year level` = c(250.1276, 285.8472),
`10-year level` = c(251.7572, 287.4767),
`20-year level` = c(261.5854, 297.3050),
`50-year level` = c(272.6819, 308.4015),
`100-year level` = c(279.9420, 315.6615)
)
library(reshape2)
return_levels_df <- as.data.frame(return_levels)
return_levels_df
rperiods = c(2, 5, 10, 20, 50, 80, 100, 120, 200, 250, 300, 500, 800,2000,5000)
return_levels <- return.level(gev_fit_accelerating, return.period = rperiods, qcov = qcovs)
return_levels
type(return_levels)
class(return_levels)
return_levels_df <- as.data.frame(return_levels)
return_levels_df
return_levels$return.period
return_levels_df <- as.data.frame(return_levels)
return_levels_df <- return_levels_df[1:2, ]
return_levels_df
library(tidyr)
return_levels_long <- pivot_longer(
return_levels_df,
cols = everything(),  # Specify that all columns should be pivoted
names_to = "Return_Period",  # Name of the new column for the original column names
values_to = "Return_Level"  # Name of the new column for the values
)
class(return_levels_df)
return_levels_df <- as.data.frame(return_levels)
return_levels_df <- return_levels_df[1:2, ]
class(return_levels_df)
return_levels_df <- as.data.frame(return_levels)
class(return_levels_df)
return_levels_df <- return_levels_df[1:2, , drop = FALSE]
class(return_levels_df)
return_levels_long <- pivot_longer(
return_levels_df,
cols = everything(),  # Specify that all columns should be pivoted
names_to = "Return_Period",  # Name of the new column for the original column names
values_to = "Return_Level"  # Name of the new column for the values
)
return_levels_long
return_levels_df
names(return_levels_df) <- rperiods
length(rperiods)
names(return_levels_df)
return_levels_df
return_levels <- return.level(gev_fit_accelerating, return.period = rperiods, qcov = qcovs)
return_levels_df
write.csv(return_levels_df, "return_levels.csv", row.names = FALSE)
era5_p90_count <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_extreme_fwi_days_N_America.csv')
era5_p90_count$Year <- as.Date(era5_yearly_max$Year)
ggplot(era5_p90_count, aes(x = Year, y = p95_count)) +
geom_line() +  # Line plot
labs(title = "Plot of FWINX over Time",
x = "Time",
y = "FWINX") +
theme_minimal()  # Optional: Use a minimal theme for a cleaner look
era5_p90_count <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_extreme_fwi_days_N_America.csv')
era5_p90_count$Year <- as.Date(era5_yearly_max$Year)
era5_p90_count <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_extreme_fwi_days_N_America.csv')
era5_p90_count$Year <- as.Date(era5_yearly_max$Year)
era5_p90_count <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_extreme_fwi_days_N_America.csv')
era5_p90_count$Year <- as.Date(era5_p90_count$Year)
era5_p90_count <- era5_yearly_max[order(era5_p90_count$time), ]
era5_p90_count <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_extreme_fwi_days_N_America.csv')
era5_p90_count$Year <- as.Date(era5_p90_count$Year)
era5_p90_count <- era5_yearly_max[order(Year), ]
era5_p90_count <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_extreme_fwi_days_N_America.csv')
era5_p90_count$Year <- as.Date(era5_p90_count$Year)
era5_p90_count <- era5_p90_count[order(Year), ]
View(era5_p90_count)
era5_p95_count <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_extreme_fwi_days_N_America.csv')
era5_p95_count$Year <- as.Date(era5_p95_count$Year)
ggplot(era5_p90_count, aes(x = Year, y = p95_count)) +
geom_line() +  # Line plot
labs(title = "Plot of FWINX over Time",
x = "Time",
y = "FWINX") +
theme_minimal()  # Optional: Use a minimal theme for a cleaner look
gev_fit_nonstat_p95 <- fevd(x = era5_p95_count$p95_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p95
gev_fit_accelerating
gev_fit_nonstat_p90 <- fevd(x = era5_p95_count$p90_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p99 <- fevd(x = era5_p95_count$p99_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p90
gev_fit_nonstat_p95
gev_fit_nonstat_p99
gev_fit_nonstat_p995 <- fevd(x = era5_p95_count$p995_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p995
gev_fit_nonstat_p95 <- fevd(x = era5_p95_count$p95_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p95_2 <- fevd(x = era5_p95_count$p95_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
#scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
lr.test(gev_fit_nonstat_p95_2, gev_fit_nonstat_p95)
gev_fit_nonstat_p95_2
gev_fit_nonstat_p95
gev_fit_nonstat_p95$year_index <- gev_fit_nonstat_p95$Year - min(gev_fit_nonstat_p95$Year)
era5_p95_count$year_index <- era5_p95_count$Year - min(era5_p95_count$Year)
gev_fit_nonstat_p95_acc <- fevd(x = era5_p95_count$p95_count,
location.fun = ~ era5_p95_count$index + I(era5_p95_count$index^2),
#scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p95_acc <- fevd(x = era5_p95_count$p95_count,
location.fun = ~ era5_p95_count$year_index + I(era5_p95_count$year_index^2),
#scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
View(era5_p95_count)
era5_p95_count$Year <- format(era5_p95_count$Year, "%Y")
era5_p95_count$year_index <- era5_p95_count$Year - min(era5_p95_count$Year)
era5_p95_count <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_extreme_fwi_days_N_America.csv')
era5_p95_count$Year <- as.Date(era5_p95_count$Year)
era5_p95_count <- read_csv('../../data/UNSEEN/wildfire/cems/preprocessed/ERA5_extreme_fwi_days_N_America.csv')
era5_p95_count$year_index <- era5_p95_count$Year - min(era5_p95_count$Year)
gev_fit_nonstat_p90 <- fevd(x = era5_p95_count$p90_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p90
gev_fit_nonstat_p95 <- fevd(x = era5_p95_count$p95_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p95
gev_fit_nonstat_p95_acc <- fevd(x = era5_p95_count$p95_count,
location.fun = ~ era5_p95_count$year_index + I(era5_p95_count$year_index^2),
#scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p95_acc
min_index <- min(era5_p95_count$index)
max_index <- max(era5_p95_count$index)
min_index <- min(era5_p95_count$year_index)
max_index <- max(era5_p95_count$year_index)
return_levels <- return.level(gev_fit_nonstat_p95_acc, return.period = c(5, 6, 7, 8, 9, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
return_levels <- return.level(gev_fit_nonstat_p95, return.period = c(5, 6, 7, 8, 9, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
gev_fit_nonstat_p95 <- fevd(x = era5_p95_count$p95_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
min_index <- min(era5_p95_count$year_index)
max_index <- max(era5_p95_count$year_index)
qcovs <- make.qcov(gev_fit_accelerating, vals = list(mu1 = c(min_index, max_index),
mu2 = c(min_index^2, max_index^2)))
return_levels <- return.level(gev_fit_nonstat_p95, return.period = c(5, 6, 7, 8, 9, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
max_index
qcovs <- make.qcov(gev_fit_nonstat_p99, vals = list(mu1 = c(min_index, max_index),
mu2 = c(min_index^2, max_index^2)))
gev_fit_nonstat_p99
min_index <- min(era5_p95_count$year_index)
max_index <- max(era5_p95_count$year_index)
qcovs <- make.qcov(gev_fit_nonstat_p95, vals = list(mu1 = c(min_index, max_index),
mu2 = c(min_index^2, max_index^2)))
qcovs <- make.qcov(gev_fit_nonstat_p95_acc, vals = list(mu1 = c(min_index, max_index),
mu2 = c(min_index^2, max_index^2)))
return_levels <- return.level(gev_fit_nonstat_p95_acc, return.period = c(5, 6, 7, 8, 9, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
gev_fit_nonstat_p95_acc <- fevd(x = era5_p95_count$p95_count,
location.fun = ~ era5_p95_count$year_index + I(era5_p95_count$year_index^2),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
min_index <- min(era5_p95_count$year_index)
max_index <- max(era5_p95_count$year_index)
qcovs <- make.qcov(gev_fit_nonstat_p95_acc, vals = list(mu1 = c(min_index, max_index),
mu2 = c(min_index^2, max_index^2)))
return_levels <- return.level(gev_fit_nonstat_p95_acc, return.period = c(5, 6, 7, 8, 9, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
gev_fit_nonstat_p95_acc <- fevd(x = era5_p95_count$p95_count,
location.fun = ~ era5_p95_count$year_index + I(era5_p95_count$year_index^2),
scale.fun = ~ era5_p95_count$year_index + I(era5_p95_count$year_index^2),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p95_acc <- fevd(x = era5_p95_count$p95_count,
location.fun = ~ era5_p95_count$year_index + I(era5_p95_count$year_index^2),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p95_acc_2 <- fevd(x = era5_p95_count$p95_count,
location.fun = ~ era5_p95_count$year_index + I(era5_p95_count$year_index^2),
#scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p95_acc
gev_fit_nonstat_p95_acc_2
lr.test(gev_fit_nonstat_p95_acc, gev_fit_nonstat_p95_acc_2)
lr.test(gev_fit_nonstat_p95_acc_2, gev_fit_nonstat_p95_acc)
gev_fit_nonstat_p95 <- fevd(x = era5_p95_count$p95_count,
location.fun = ~c(1:length(era5_p95_count$Year)),
scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
gev_fit_nonstat_p95
gev_fit_nonstat_p95_acc <- fevd(x = era5_p95_count$p95_count,
location.fun = ~ era5_p95_count$year_index + I(era5_p95_count$year_index^2),
#scale.fun = ~c(1:length(era5_p95_count$Year)),
use.phi = TRUE,
type = "GEV")
qcovs <- make.qcov(gev_fit_nonstat_p95_acc, vals = list(mu1 = c(min_index, max_index),
mu2 = c(min_index^2, max_index^2)))
return_levels <- return.level(gev_fit_nonstat_p95_acc, return.period = c(5, 6, 7, 8, 9, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
return_levels <- return.level(gev_fit_nonstat_p95_acc, return.period = c(3,4,5, 6, 7, 8, 9, 10, 20, 50, 100), qcov = qcovs)
print(return_levels)
